(2/4 완료) 케이스티파이 런칭 스테이징 테스트 지원
 . 신용카드 결제 시 이벤트 별 미적립 맞는지 재확인
 . 반품 시 적립별 회수여부 등 다양한 테스트케이스 작성
(2/3 완료) 크롤링 방지를 위한 robots.txt 적용
(2/3 완료) 케이스티파이 쿠폰 LMS 문구 변경
 . 내용 : 케이스티파이 상품 구매 시 텀블러 쿠폰 LMS 문구 변경 (텀블러 → 케이스티파이)
 . 텀쿠 LMS 추가 파라미터 명 : eventCode
 /WEB-INF/classes/kr/co/starbucks/giftshop/admin/common/utils/MsrApiUtil.class
 /WEB-INF/classes/kr/co/starbucks/giftshop/admin/reward/vo/RewardVO.class
 /WEB-INF/classes/kr/co/starbucks/giftshop/admin/reward/service/RewardServiceImpl.class
 /WEB-INF/classes/kr/co/starbucks/giftshop/batch/service/GiftShopBatchValidationService.class
 /WEB-INF/classes/mappers/oracle/giftshop/admin/RewardMapper.xml
 /WEB-INF/classes/batch/query/kr/co/starbucks/giftshop/BatchValidationQuery.xml
 ※ 쿠폰 재전송 기능은 미사용인듯.. 미발급 쿠폰만 대상이고, 오류 로그를 보면 응답전문에서 "data" 거르고 "couponResult"를 불러오기 때문에 null포인터 익셉션이 난다. 정상적으로 수행시키려면 cardList처럼 "data"로 받아서 "couponResult"를 getJSONArray()로 한번 더 불러와야함.
  오류났다는 alert창이 뜬 시점에 쿠폰발송 완료되고 쿠폰상태 업데이트, 히스토리도 다 쌓임.
(1/26 완료) 현금영수증 재실행 배치 생성 : IfCashReAccTransJob - 현금영수증승인 배치(수동용)
 . 목록을 확인할 수 있으나 재실행할 방법이 없어서 실패로 계속 남아있음 (전날것만 수행하기 때문에 그 전에 실패된것이 남아있는 상황)
/WEB-INF/classes/batch/config/kr/co/starbucks/giftshop/if/IfCashAccTransJob.xml
/WEB-INF/classes/batch/config/kr/co/starbucks/giftshop/if/IfCashReAccTransJob.xml
/WEB-INF/classes/kr/co/starbucks/giftshop/batch/tasklet/IfCashTransTasklet.class
(1/26 완료) 신용카드 최소결제금액 변경(1000원→100원)
 . 참고 메일 : FW: [스타벅스] 신용카드 결제 최소금액 조정의 건
 /WEB-INF/classes/templates/views/payment/fragments/notiSet.html
 /WEB-INF/classes/templates/views/payment/main.html
 /WEB-INF/classes/templates/views/payment/pg/inicis/request.html
 /WEB-INF/classes/templates/views/payment/requestForm.html
 /WEB-INF/classes/templates/views/return/payment.html
 /WEB-INF/jsp/payment/request.jsp
 /WEB-INF/classes/templates/views/sample/list.html
(1/26 완료) 카드영수증 <br> 태그 제거
 /WEB-INF/classes/templates/views/giftbox/receipts/card_receipt.html
(1/26 완료) coconut thymeleaf Exception 조치
 . error_page.html 내 thymeleaf 문법 제거
 /error_page.html
 /WEB-INF/classes/templates/error_page.html
(1/26 완료) [VOC 처리] 백신서버 통신 오류로 인한 농협 신용카드 일반결제 불가 현상 확인
 -> user-agent 미가공앱 배포 시 해결 될 것으로 예상한다는 내용을 1/26에 공유함. 실제로 해결되는지는 앱 배포 이후 확인 가능.
(1/20 완료) 악성고객 (WIN2KD) 7,100원 누락 수기취소 진행 : 현업이 수기 증액 진행
(1/19 완료) 카드 환불시 배송하기 주문상태 체크 API (~1/27)
 . 스테이징 테스트
[ https://stg-](https://stg-www.starbucks.co.kr:3443/giftshop/api/checkCardRefundAvailIf.do?usrId=212816&cardNumber=1111111111111111)[gifton](https://stg-gifton.starbucks.co.kr:4443/giftshop/api/getInvntQntyIf.do?rsrcNo=1819)[.istarbucks.co.kr:4443/giftshop/api/checkCardRefundAvailIf.do?usrId=212816&cardRegNumber=1111111111111111](https://stg-www.starbucks.co.kr:3443/giftshop/api/checkCardRefundAvailIf.do?usrId=212816&cardNumber=1111111111111111)
 /WEB-INF/classes/kr/co/starbucks/giftshop/api/controller/IfGiftShopController.class
 /WEB-INF/classes/kr/co/starbucks/giftshop/api/service/IfGiftShopService.class
 /WEB-INF/classes/kr/co/starbucks/giftshop/api/service/IfGiftShopServiceImpl.class
 /WEB-INF/classes/kr/co/starbucks/giftshop/api/mapper/IfGiftShopMapper.class
 /WEB-INF/classes/mappers/oracle/giftshop/api/IfGiftShopMapper.xml
(1/19 완료) 시스템 내 (주)스타벅스코리아 -> SCK COMPANY 사명 텍스트 변경
 . LMS는 동건님이 진행 예정
 . 이미지는 써클엠에서 이미지 교체 예정
(1/19 완료) 메티스 오류 조치 ([giftReceive.do](http://giftreceive.do/) 400 오류 발생 조치 필요) : 1/19(수) 배포 예정
 /WEB-INF/classes/mappers/oracle/giftshop/biz/shipping/controller/ShippingController.class
(1/19 완료) SR카드 중복환불 건 (취소요청 중복 발생) 분석을 위한 로그 추가 원복 (고도화 프로젝트 주문/결제 연동강화 요건으로 처리예정)
(1/14 완료) 1월 주문실패/주문취소실패 및 PG대사 불일치건 보정
 -> 악성고객 모바일 상품권 중복사용, 신용카드 인증결제 중복 호출, 1/12 FD 통신 장애로 인한 주문취소실패
(1/13 완료) [VOC 처리] 구매확정된 주문 쿠폰 미발행 확인
 -> 구매확정 배치 실패로 인해 쿠폰 대상 테이블 미입력되어 1/12 수기 입력하여 13일 발행됨
(1/12 완료) [VOC 처리] 결제는 됐는데 주문 내역에서 조회되지 않음
 -> 주문실패관리의 강제취소 기능을 통하여 결제 취소처리 (결제/취소 수차례 반복 고객)
(1/11 완료) 모상 일시제한 이후 모상 포함된 결제건이 있는지 모니터링 추가
(1/11 완료) 기프티쇼 중복승인 건 확인
 -> 11월 gift배송에서 사용후 익일취소진행, 12월 기프티쇼 고객센터 통해 모상 환불받은 후 사이렌오더에서 사용 (악성고객)
(1/11 완료) [VOC 처리] 주문한 내역이 확인되지 않고 결제된 상태 (RNJSTNALZZ)
 -> 주문데이터 수기 생성 후 주문실패 화면에서 취소 진행 (550,000원)
(1/11 완료) BO 주문 실패 목록 SQL 튜닝 적용
 . /WEB-INF/classes/mappers/oracle/giftshop/admin/OrderMapper.xml
(1/11 완료) P_up 관련 모바일상품권 사용 제한 문구 적용
 . 1/12 07:00 적용 될 수 있도록 1/11 배포 필수!
/WEB-INF/classes/kr/co/starbucks/giftshop/biz/afterOrder/controller/RepaymentController.class
/WEB-INF/classes/kr/co/starbucks/giftshop/biz/payment/controller/PaymentINIController.class
/WEB-INF/classes/kr/co/starbucks/giftshop/biz/payment/controller/PaymentSRcardController.class
/WEB-INF/classes/kr/co/starbucks/giftshop/biz/payment/function/PaymentValidation.class
/WEB-INF/classes/message/message-gs-error_ko_KR.properties
/WEB-INF/classes/templates/views/payment/fragments/notiSet.html
/WEB-INF/classes/templates/views/payment/fragments/popupSet.html
/WEB-INF/classes/templates/views/payment/main.html
/WEB-INF/classes/templates/views/return/payment.html
(1/11 완료) 사이렌오더 MD판매 도입PJT 딥링크 관련 개발 지원 (웹뷰닫기)
 . /WEB-INF/classes/templates/views/fragments/view_header.html
(1/11 완료) 재고 체크 API 개발
 . 재고체크 API 연동 규격

| **URL** : /giftshop/api/[getInvntQntyIf.do](http://getinvntqntyif.do/) |                |               |               |                                                              |
| ------------------------------------------------------------ | -------------- | ------------- | ------------- | ------------------------------------------------------------ |
| 입력 파라미터                                                |                |               |               |                                                              |
| **매개변수명**                                               | **설명**       | **필수/선택** |               |                                                              |
| rsrcNo                                                       | SKU번호        | 필수          |               |                                                              |
| 응답 파라미터                                                |                |               |               |                                                              |
| **depth**                                                    | **매개변수명** | **설명**      | **필수/선택** | **비고**                                                     |
| 1                                                            | invntQnty      | 재고수량      | 필수          |                                                              |
| 1                                                            | detailUrl      | 상품상세URL   | 선택          | 재고수량이 0보다 큰 경우 제공 : /[detail.do?goodsCode=${goodsCode](http://detail.do/?goodsCode=${goodsCode)} |

 . 스테이징 테스트
 1) 재고 O : [https://stg-www.starbucks.co.kr:3443/giftshop/api/getInvntQntyIf.do?rsrcNo=11067453](https://stg-gifton.starbucks.co.kr:4443/giftshop/api/getInvntQntyIf.do?rsrcNo=11067453)
 2) 재고 X : [https://stg-www.starbucks.co.kr:3443/giftshop/api/getInvntQntyIf.do?rsrcNo=11071645](https://stg-gifton.starbucks.co.kr:4443/giftshop/api/getInvntQntyIf.do?rsrcNo=11071645)
 3) 데이터 미조회 : [https://stg-www.starbucks.co.kr:3443/giftshop/api/getInvntQntyIf.do?rsrcNo=1819](https://stg-gifton.starbucks.co.kr:4443/giftshop/api/getInvntQntyIf.do?rsrcNo=1819)
 /WEB-INF/classes/kr/co/starbucks/giftshop/biz/api/controller/ApiController.class
 /WEB-INF/classes/kr/co/starbucks/giftshop/biz/api/service/ApiService.class
 /WEB-INF/classes/kr/co/starbucks/giftshop/biz/api/mapper/ApiMapper.class
 /WEB-INF/classes/mappers/oracle/giftshop/mapper-api.xml
 /WEB-INF/classes/application.yml
 /WEB-INF/classes/application-dev.yml
 /WEB-INF/classes/application-stg.yml
 /WEB-INF/classes/application-dr.yml
 /WEB-INF/classes/application-prod.yml
(1/6 완료) 배송상품일별집계 쿼리 튜닝 이후 배포, 그전까지는 아침마다 조유진파트너에게 수기로 넘기기
 (BO) /WEB-INF/classes/batch/config/kr/co/starbucks/giftshop/agrgt/IfStatDlvySumJob.xml
(1/6 완료) 주문실패 원인분석용 : catch 문에 log 찍기 배포
 (FO) /WEB-INF/classes/kr/co/starbucks/giftshop/biz/afterOrder/controller/CancelController.class
 (FO) /WEB-INF/classes/kr/co/starbucks/giftshop/biz/msr/controller/MsrApiController.class
 (FO) /WEB-INF/classes/kr/co/starbucks/giftshop/biz/error/controller/SbErrorController.class
 (FO) /WEB-INF/classes/kr/co/starbucks/giftshop/biz/payment/controller/PaymentINIController.class
 (FO) /WEB-INF/classes/kr/co/starbucks/giftshop/biz/payment/controller/PaymentController.class
 (FO) /WEB-INF/classes/kr/co/starbucks/giftshop/biz/log/service/UserLogService.class
 (FO) /WEB-INF/classes/kr/co/starbucks/giftshop/biz/payment/function/PaymentValidation.class
 (FO) /WEB-INF/classes/kr/co/starbucks/giftshop/biz/payment/service/PaymentServiceImpl.class
 (FO) /WEB-INF/classes/kr/co/starbucks/giftshop/biz/shipping/controller/ShippingApiController.class
 (FO) /WEB-INF/classes/kr/co/starbucks/giftshop/biz/shipping/controller/ShippingController.class
 (FO) /WEB-INF/classes/kr/co/starbucks/giftshop/biz/payment/controller/PaymentSRcardController.class
 (FO) /WEB-INF/classes/kr/co/starbucks/giftshop/biz/afterOrder/service/ApproveService.class
(1/6 완료) GAS #1289510 조치
 . 개발자도구 콘솔로그 찍히는 현상 조치 (차단패턴 추가 : [ javascript:, console., log( ])
 /WEB-INF/classes/lucy-xss-servlet-filter-rule.xml
(1/6 완료) logback 취약점으로 인한 버전 업데이트 (~12/31)
 : BO / FO 둘다 적용
 /WEB-INF/lib/logback-classic-1.2.9.jar (추가)
 /WEB-INF/lib/logback-core-1.2.9.jar (추가)
 /WEB-INF/lib/logback-classic-1.2.3.jar (삭제)
 /WEB-INF/lib/logback-core-1.2.3.jar (삭제)
(1/6 완료) 비회원 분리보관시 주문전체상태 대상으로 변경
 (BO) /WEB-INF/classes/batch/config/kr/co/starbucks/giftshop/BatchDlvyAdrsCsdtyJob.xml
(1/6 완료) API에 배송완료일시 없을 경우 현재 일시 찍기
 WEB-INF/classes/kr/co/starbucks/giftshop/util/DlvyTrackUtil.class
(1/6 완료) [VOC 처리] 주문한 내역이 확인되지 않고 결제된 상태 (ADD7982)
 . 내용 : 기간만료 SR카드 사용으로 인한 주문실패 건
 . 현상 : 주문실패 되었으나 스타벅스 카드 결제되고 주문내역 확인 불가
 . 원인 : 여러 장의 카드 복합 결제 중 만료된 카드 사용으로 인해 주문이 실패되었으며, 실제로는 결제내역 롤백되어 카드잔액 복구되었지만, 잔액이 올바르게 표시되지 않음.
 . 처리 : 12월 15일에도 동일 내용으로 VOC 인입되어 처리 이력이 있으며, 동일하게 잔액 보정 처리 완료 (SR)



[ 가격인상 관련 기프트배송 변경내용 정리 ]

\# 확인필요사항
? 익일취소시 모상 원복 -> 할인받은 주문건 뿐만 아니라 전체 (고도화때 개발할걸 유지운영으로 개발시로 검토 하는것)
 => 반품 시 판매자 귀책인 경우 기존대로 SR카드 생성 적용할지 검토 필요
? 할인내역노출 -> 임직원 000 원, ㅇㅇ할인 0000원 나눠서 보여줌
? 선수금, 정산 방식 논의 필요ㅁ
? 할인 이벤트 진행시
? 현재 당일취소시 모상 원복처리 하고있음
-> 익일 취소여도 할인받은 주문건은 당일 취소처럼 처리
---> 유효기간 지난건은 어떻게 할 것인가 ? 
----> 유효기간 지난건에 대해 취소를 하면 제휴사 발행처에서 이슈가 없는지
유효기간 지나서 취소안됨으로 응답이 올경우 최종적으로 기프트 배송에서 주문취소실패 날 가능성이 있음

\# 주문하기 
\- 제휴사 상품권 사용가능 조회시 API 변경처리
-> 응답값에 할인금액 항목 추가 하면 공수가 줄어듦
(결제완료 프로세스까지 20M/D)

\# 주문취소
현재 SR에서 익일 취소여부 확인 후 새SR카드 등록및 환불 처리 -> SR로직 확인필요
-> 변경1안) SR에서 알아서 모상취소 or 익일취소 처리 (취소 API 수정 X) -> 기프트배송 작업 X
-> 변경2안) 취소 API에 할인여부 파라미터 추가 하여 SR에서 해당파라미터 값으로 분기 -> 기프트 배송 작업 필요 10M/D

\# 12/2 버전
-> 1차 : eGift 아이템, 제휴사 모상 전체 사용 제한 - 1/1 00시 적용 (alert문구 현업에서 전달 예정)
-> 2차 : 사용기준은 할인적용으로 상기와 같으며 개발은 고도화 프로젝트에서 진행 예정 (써클엠)



<금주>
\- 한글 아이디 유저 배송 서비스 정상 사용 가능하도록 조치
 . SR에서도 같이 개선이 필요함, **스테이징 한글아이디 로그인 불가 이슈 해결 후 일정 잡을 수 있음**
 . 구매확정 배치 시 us7asciiColumnMapRowMapper 제거 후 테스트
 . 한글아이디 제휴사 모상 사용 가능여부 조회 API 테스트
(한글아이디 완료시)
\- BO 사용자 삭제 로직 변경
\- 앱으로 선물을 받았는데 웹에서 받은것으로 보이는 현상 확인 (BO)

<차주이후>
\- 취소 두번 호출되는 건 분석????
 . synchronized 사용
\- 권한그룹 생성 시 하기 메뉴 자동으로 세팅되도록 변경
 . CO 비메뉴공통
 . CO0010 팝업
 . CO0020 프레임
\- SR 조회 DB 작업 : 16일에서 17일 넘어가는 새벽 작업 (23:00 ~ 03:00)
 . 해당시간 SR API 호출하는 배치 조정
\- 탈퇴, 휴면 등 분리보관 된 정보(주문, 결제, 배송지)를 5년 뒤 삭제 하는 배치 추가 (1차 프로젝트 당시 누락된 건 파트너님 통해서 요청 예정)
 . 진행상태 : 분석 필요
\- 매일 00~08시 취소금액합계, 취소건수 전달 (블라썸 푸시)
 . 고송희 파트너, 조유진 파트너에게 전달(상부 보고용)
 . 실적조회 > 일자별 주문조회 항목 추가 요망 -> 개발 전까지는 임시로 검증 등록 후 푸시 받아 매일 아침에 블톡으로 전달 예정 (12/24 ~ )
 . 일자별주문조회 메뉴에 추가 요청 올 예정
\- 반품 시 판매자 귀책인 경우에도 이전 결제에 구매자 귀책으로 인해 배송비가 포함된 경우 배송비 결제하도록 로직 개선 (고도화 프로젝트 주문/결제 연동강화 요건으로 처리예정)
\- 모상 사용 주문의 선물거절 익일 취소 시 결제 마스터에 환불카드 정보 업데이트 로직 개발 (고도화 프로젝트 주문/결제 연동강화 요건으로 처리예정)
\- FO 상품리스트 상단 일시품절 제외하고 보기 체크박스 추가
 . API 개발 후 12월 중순부터 착수 가능으로 회신함 (7MD)
\- 텀블러 쿠폰 회수할수 있는 쿠폰이있으면 먼저 회수하도록 개선 (고도화 프로젝트 주문/결제 연동강화 요건으로 처리예정)
\- 구매확정 이후 텀블러 쿠폰 미발행 건 유무 체크 모니터링 등록
\- userAgent 관련하여 소스 수정해야할수도 있음
 . 현재는 checkProfilesConditions()에서 무조건 false로 반환하므로 userAgent 커스터마이징 하던 안하던 시스템 영향이 없으나 해당 로직을 정상적으로 사용하려면 시스템 변경이 필요함
 (예시)

**소스1**if (navigator.userAgent.toLocaleLowerCase().indexOf("android") > -1) {      msg += "\n\n*안드로이드 기반의 모바일 기기에서 이벤트 참여 시 chrome을 사용하시면 보다 안정적으로 공유하여 이벤트에 참여하실 수 있습니다.";}      **소스2**if (navigator.userAgent.toLowerCase().indexOf("android") > -1) {      this.param.channel = "A";}

<후순위>
\- 이니시스 인증 결제 확인 (망취소) (고도화 프로젝트 주문/결제 연동강화 요건으로 처리예정)
 . 정상성공후 뒤로가기로 인한 인증 오류로 재현 해볼필요 있음
 . 결제 로직 로그 레벨 조정 (PaymentINIController.java)
\- [SLM0006210] e-Gift Item Daily Report [유형별 채널별 판매/사용 실적 기준] 탭 금액 조회 개선
 프로젝트 : xobatch (XO 배치)
 파일명 : xoGift.xml
 쿼리 ID : xoGift.saveXoStatGiftChnlSum > POS 결제/취소 목록
 참조해야할 테이블 :  XO_POS_INFO.RCV_ZONE_DVSN_CODE
\- [BO] 현금영수증 관리 > 전송이력 조회 메뉴 내 결제번호/순번 검색조건에 문자열입력 시 Exception 발생 조치
\- 탈퇴/휴면 계정 분리보관 배치 수정 : 항목은 이미 있으나 추가 점검 필요, 휴면 해제 시 원복하는 배치 추가 필요 (1차 프로젝트 당시 누락된 건 파트너님 통해서 요청 예정)
\- 반품 요청 시 결제된 배송비가 반품요청철회 시 추가배송비가 삭제되지 않은것으로 보임 (삭제되도록 프로그램 수정 필요할듯) - 하기 내용과 연관 있어보임. (고도화 프로젝트 주문/결제 연동강화 요건으로 처리예정)
 9/27 확인요청
 1개 상품 반품요청 -> 반품요청철회 ( D2021091016051703941 )
 최초 주문금액 : 40000원
 반품요청 재결제 : 6천원  - 9/20
 반품요청 철회 : -6천원   - 9/23
 최종 매출금액 : 43000원  - 배송비 9/20 자로 3천원 잡힘
\- 배송요청배치 4step 추가 : 주문6검증 update처리 (마스터랑 상세의 상태값이 다른 케이스)
\- 배송완료배치 택배사별 조회 후 배송완료처리 기능 추가